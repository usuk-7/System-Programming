## 📖 10장 Bash 쉘 스크립트

### 📌 강의 개요
이 강의에서는 Bash 쉘 스크립트에 대한 내용을 다루며, 주요 학습 내용은 다음과 같습니다:
* Bash 쉘 소개
* 별명 및 히스토리 기능
* 변수
* 지역 변수와 환경 변수
* Bash 쉘 스크립트
* 수식
* 조건문
* 반복문
* 고급 기능

---

### ☑️ 10.1 Bash 쉘 소개

* **Bash(Borne-again shell)**: 리눅스, 맥 OS X 등의 운영 체제의 기본 쉘이며, 본 쉘의 문법을 대부분 수용하면서 확장되었다.
* **시작 파일 (start-up file)**:
    * `/etc/profile`: 전체 사용자에게 적용되는 환경 설정 및 시작 프로그램 지정
    * `/etc/bash.bashrc`: 전체 사용자에게 적용되는 별명과 함수 정의
    * `~/.bash_profile`: 각 사용자를 위한 환경 설정 및 시작 프로그램 지정
    * `~/.bashrc`: 각 사용자를 위한 별명과 함수 정의
* **Bash 시작 과정**: 로그인 시 `/etc/profile` -> `/etc/bash.bashrc` -> `~/.bash_profile` -> `~/.bashrc` 순으로 시작 파일이 실행되고 프롬프트가 출력된다.
* **시작 파일 예 (`.bash_profile`, `.bashrc`)**: 환경 변수 설정 및 별명 설정 등이 포함된 스크립트 예시를 보여준다. 

---

### ☑️ 10.2 별명 및 히스토리 기능

* **별명 (`alias`)**: 기존 명령어에 대한 새로운 이름을 정의한다. `alias` 명령어로 정의된 별명 리스트를 확인하고, `unalias` 명령어로 별명을 해제할 수 있다.
* **히스토리 (`history`)**: 입력된 명령들을 기억하는 기능이다. `HISTSIZE` 변수로 기억할 히스토리 크기를 설정하고, `HISTFILESIZE` 변수로 로그아웃 후에도 히스토리가 저장되도록 설정한다.
* **재실행**:
    * `!!`: 바로 전 명령 재실행
    * `!n`: 이벤트 번호가 n인 명령 재실행
    * `!시작스트링`: 시작스트링으로 시작하는 최후 명령 재실행
    * `!?서브스트링`: 서브스트링을 포함하는 최후 명령 재실행

---

### ☑️ 10.3 변수

* **단순 변수 (simple variable)**: 하나의 값(문자열)만을 저장할 수 있는 변수이다. `변수이름=문자열` 형식으로 선언하고, `$변수이름`으로 값을 사용한다. 한 번에 여러 개의 변수를 생성하거나, 한글 문자열 및 여러 단어로 구성된 문자열도 저장 가능하다.
* **리스트 변수 (list variable)**: 한 변수에 여러 개의 값(문자열)을 저장할 수 있는 변수이다. `이름=(문자열리스트)` 형식으로 선언하며, `\${name[i]}`로 특정 원소에, `\${name[*]}` 또는 `\${name[@]}`로 모든 원소에 접근한다. `\${#name[*]}` 또는 `\${#name[@]}`로 원소 개수를 확인한다.새로운 도시 추가 예시가 있다.
* **표준입력 읽기 (`read`)**: `read` 명령어로 표준입력에서 한 줄을 읽어서 단어들을 변수들에 순서대로 저장한다. 마지막 변수에는 남은 문자열을 모두 저장한다.

---

### ☑️ 10.4 지역 변수와 환경 변수

* **쉘 변수**: 환경변수와 지역변수 두 종류로 나눌 수 있다. 환경 변수는 값이 자식 프로세스에게 상속되지만, 지역변수는 그렇지 않다.
* **환경변수와 지역변수 예**: `export` 명령어를 사용하여 지역변수를 환경변수로 만들고 자식 쉘에서 접근하는 예시가 제시된다.
* **사전 정의 환경변수 (predefined environment variable)**: `$USER`(사용자 이름), `$TERM`(터미널 타입), `$PATH`(명령어 검색 디렉터리 리스트), `$HOME`(홈 디렉터리), `$SHELL`(로그인 쉘 경로), `$MAIL`(메일 박스 경로), `$HOSTNAME`(호스트 이름) 등이 있다.
* **사전 정의 지역 변수 (predefined local variable)**: `$$`(쉘의 프로세스 번호), `$0`(쉘 스크립트 이름), `$1`~`$9`(명령줄 인수), `$*`(모든 명령줄 인수 리스트), ` 의료비 `$#`(명령줄 인수의 개수) 등이 있다.

---

### ☑️ 10.5 Bash 쉘 스크립트

* **Bash 스크립트 작성 및 실행 과정**:
    1.  에디터를 사용하여 Bash 스크립트 파일을 작성한다. (`#!/bin/bash`로 시작)
    2.  `chmod`를 이용하여 실행 모드로 변경한다 (`chmod +x 스크립트파일`).
    3.  스크립트 이름을 타입핑하여 실행한다 (`./스크립트파일`).
* **`if` 문**: 조건식의 참/거짓에 따라 명령들을 실행한다. `if [ 조건식 ] then 명령들 fi` 구문을 사용한다. 명령줄 인수의 개수를 확인하고 `wc` 명령어를 실행하는 예시가 있다.
* **`if-then-else` 구문**: 조건식에 따라 `then` 블록 또는 `else` 블록의 명령들을 실행한다. `if 조건식 then 명령들 else 명령들 fi` 구문을 사용한다. 대상 디렉터리 내의 파일과 서브디렉터리 개수를 프린트하는 예시가 있다.

---

### ☑️ 10.6 수식

* **비교 연산**: 산술 비교 연산과 문자열 비교 연산으로 나뉜다.
    * **산술 비교 연산자**: `-eq`(같음), `-ne`(같지 않음), `-gt`(큼), `-ge`(크거나 같음), `-lt`(작음), `-le`(작거나 같음) 등이 있다.
    * **문자열 비교 연산자**: `==` (같음), `!=` (다름), `-n 문자열` (null이 아니면 참), `-z 문자열` (null이면 참) 등이 있다. `reply.bash` 예시를 통해 사용자가 'y' 또는 'Y'를 입력하면 "계속합니다"를 출력하는 조건문이 제시된다.
* **파일 관련 연산**:
    * `-a 파일`, `-e 파일`: 파일이 존재하면 참
    * `-r 파일`, `-w 파일`, `-x 파일`: 사용자가 파일 읽기/쓰기/실행 가능하면 참
    * `-o 파일`: 사용자가 파일의 소유자이면 참
    * `-z 파일`: 파일 크기가 0이면 참
    * `-f 파일`: 일반 파일이면 참
    * `-d 파일`: 디렉터리이면 참
    * 파일 존재 여부 및 디렉터리 여부를 확인하는 예시가 제시된다.
* **부울 연산자**: 조건식에 `!` (부정), `&&` (논리곱), `||` (논리합)을 사용할 수 있다. 파일이 일반 파일이고 쓸 수 있는지 확인하거나, 파일 또는 디렉터리가 존재하지 않는지 확인하는 예시가 있다.
* **산술 연산**: `expr` 명령어나 `let` 명령어를 이용한 산술 연산이 가능하다. `let 변수=수식` 형식으로 사용하며, `let a*=10`, `let b++`와 같은 증감 연산도 지원한다.
* **변수 타입 선언 (`declare`)**: `declare` 명령어로 변수의 타입을 선언할 수 있다.
    * `declare -r 변수`: 읽기 전용 변수
    * `declare -i 변수`: 정수형 변수
    * `declare -a 변수`: 배열 변수
    * `declare -f`: 스크립트 안에서 정의된 모든 함수를 보여준다.
    * `declare -f 함수이름`: 해당 함수 이름을 보여준다.
    * `declare -x 변수`: 환경변수로 export
    * 정수형 변수 선언 시 소수점 값 대입 오류, 읽기 전용 변수 값 변경 시 오류 발생 예시가 있다.

---

### ☑️ 10.7 조건문

* **Bash 제어구조**: 조건문 (`if`), 스위치 (`case`), 반복문 (`for`, `while`) 등을 제공한다.
* **조건문**:
    * 기본 `if` 구문: `if 조건식 then 명령들 fi`
    * `if-else` 구문: `if 조건식 then 명령들 else 명령들 fi`
    * `if-elif-else` 구문 (중첩 조건문): `if 조건식 then 명령들 elif 조건식 then 명령들 else 명령들 fi`
* **새로운 조건식 (`if ((수식))`)**: `if ((수식))` 형태로 산술 연산을 조건식으로 사용할 수 있다. 명령줄 인수의 개수를 확인하고 `wc` 명령어를 실행하는 예시가 있다.
* **산술 연산자 (`((...))`)**: 단일항 음수, 논리 부정, 곱셈/나눗셈/나머지, 덧셈/뺄셈, 비트 좌이동/우이동, 관계 연산, 동등/비동등, 논리합/논리곱, 비트 연산자 등을 포함한다.
* **중첩 조건문 예**: 점수에 따라 학점을 결정하여 프린트하는 `score1.bash` 예시를 통해 `if-elif-else` 구문의 활용을 보여준다.
* **스위치 (`case`)**: 여러 값 중 하나에 따라 분기한다. `case $변수 in 패턴) 명령들;; ... esac` 구문을 사용한다. `score2.bash` 예시에서 점수를 10으로 나눈 값에 따라 학점을 결정하는 `case` 문이 사용된다.

---

### ☑️ 10.8 반복문

* **`for` 구문**: 리스트의 각 값에 대해서 명령어들을 반복적으로 실행한다. `for 이름 in 리스트 do 명령들 done` 형식을 사용한다. `invite.bash` 예시를 통해 리스트의 각 사람에게 초대 메일을 보내는 과정을 보여준다.
* **모든 명령줄 인수 처리**: `for file in $*` 구문을 사용하여 모든 명령줄 인수를 반복 처리할 수 있다. 파일의 사용권한과 이름을 프린트하는 `perm1.bash` 예시가 있다.
* **`while` 문**: 조건에 따라 명령어들을 반복적으로 실행한다. `while 조건식 do 명령들 done` 형식을 사용한다. 2의 1승부터 10승까지 프린트하는 `power.bash` 예시가 있다.
* **`menu.bash` 예시**: 메뉴에 따라 해당 명령어를 실행하는 `while` 반복문 스크립트 예시를 보여준다. 사용자 입력을 받아 날짜, 디렉터리 내용, 사용자 보기, 종료 등의 기능을 수행한다.

---

### ☑️ 10.9 고급 기능

* **함수**:
    * **함수 정의**: `함수이름() { 명령들 }` 형식으로 정의한다.
    * **함수 호출**: `함수이름 [매개변수들]` 형식으로 호출한다.
    * `lshead.bash` 예시에서 `/tmp` 디렉터리의 처음 3개 파일만 리스트하는 함수를 정의하고 호출하는 방법을 보여준다.
* **디버깅**: `bash -vx 스크립트 [명령줄 인수]` 명령어를 사용하여 스크립트 디버깅을 할 수 있다. `-v` 옵션은 스크립트 라인들을 읽으면서 출력하고, `-x` 옵션은 각 명령이 실행되기 직전 확장된 명령을 출력한다.
* **`shift`**: `shift [리스트변수]` 명령은 명령줄 인수(또는 리스트 변수) 내의 원소들을 하나씩 왼쪽으로 이동시킨다. 파일의 사용권한과 이름을 프린트하는 `perm2.bash` 예시에서 `shift`가 사용된다.
* **디렉터리 내의 모든 파일 처리**: 해당 디렉터리로 이동하여 `for` 문과 대표 문자 `*`를 사용하여 디렉터리 내의 모든 파일을 처리할 수 있다. 대상 디렉터리 내의 파일, 서브디렉터리, 기타 개수를 세서 프린트하는 `count2.bash` 예시가 있다.
* **리커전(recursion)**: 스크립트도 자기 자신을 호출할 수 있으며, 어떤 디렉터리의 모든 하위 디렉터리에 대해 동일한 작업을 수행할 때 매우 유용하다. `lsssr.bash` 예시에서 대상 디렉터리와 모든 하위 디렉터리 내에 있는 파일들의 크기를 재귀적으로 리스트한다.
* **터미널에서 실행**: `while` 또는 `for` 문을 터미널에서 직접 실행할 수도 있다.

---
